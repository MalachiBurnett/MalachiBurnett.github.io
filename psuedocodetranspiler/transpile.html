<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AQA Pseudocode to Python</title>
    <script src="https://cdn.jsdelivr.net/npm/skulpt@1.1.0/dist/skulpt.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/skulpt@1.1.0/dist/skulpt-stdlib.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin-bottom: 10px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>AQA Pseudocode to Python Transpiler</h1>
    <p>Enter AQA Pseudocode below:</p>
    <textarea id="pseudocodeInput" placeholder="Enter your AQA pseudocode here..."></textarea>
    <button onclick="transpileAndRun()">Transpile and Run</button>
    <h2>Python Output:</h2>
    <pre id="pythonOutput"></pre>
    <h2>Program Output:</h2>
    <pre id="programOutput"></pre>
    
    <script>
        function transpilePseudocodeToPython(pseudocode) {
            return pseudocode
                .replace(/OUTPUT\s+(.*)/g, "print(\$1)")
                .replace(/INPUT\s+(.+)/g, "\$1 = input()")
                .replace(/IF\s+(.*)\s+THEN/g, "if (\$1):")
                .replace(/ELSE/g, "else:")
                .replace(/ENDIF/g, "")
                .replace(/WHILE\s+(.*)\s+DO/g, "while (\$1):")
                .replace(/ENDWHILE/g, "")
                .replace(/FOR\s+(.*)\s+TO\s+(.*)\s+DO/g, "for \$1 in range(\$1, \$2 + 1):")
                .replace(/ENDFOR/g, "")
                .replace(/(\s*)BEGIN/g, "")
                .replace(/(\s*)END/g, "");
        }

        function executePythonCode(pythonCode, outputElementId) {
            const outputElement = document.getElementById(outputElementId);
            outputElement.textContent = ""; // Clear previous output

            function builtinRead(x) {
                if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined) {
                    throw `File not found: '${x}'`;
                }
                return Sk.builtinFiles["files"][x];
            }

            Sk.configure({
                output: (text) => { outputElement.textContent += text; },
                read: builtinRead
            });

            const myPromise = Sk.misceval.asyncToPromise(() => Sk.importMainWithBody("<stdin>", false, pythonCode, true));
            myPromise.catch((err) => {
                outputElement.textContent = `Error: ${err.toString()}`;
            });
        }

        function transpileAndRun() {
            const pseudocodeInput = document.getElementById("pseudocodeInput").value;
            const pythonOutputElement = document.getElementById("pythonOutput");
            const programOutputElement = document.getElementById("programOutput");

            try {
                const pythonCode = transpilePseudocodeToPython(pseudocodeInput);
                pythonOutputElement.textContent = pythonCode;
                executePythonCode(pythonCode, "programOutput");
            } catch (error) {
                programOutputElement.textContent = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>